---
title: "Basic Tutorial"
author: "Reinhard Simon"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

--------------------------------------------------------------
This package is under development. It has not yet been exhaustively tested for all calls neither. Usage may also still change. If you have suggestions please use the issue tracker.
--------------------------------------------------------------

# NEW

## Sandbox testing server

To ease local testing the package has now a companion package with a localized simple testing server implementing the BrAPI v1 protocol. To start this server use in an R session:

```{r eval=FALSE}

brapiTS::mock_server()

```

or on the command line in an MS-DOS box

```{r eval=FALSE}

R -e "brapiTS::mock_server()"

```

The server must be started in a R session separate from the one use for the BrAPI calls.
The server uses by default the port 2021. This can be changed by using the port parameter: brapi::mock_server(80).

Soon, the mock_server function will be moved to its own package 'brapiTS'.

# Starting the connection

```{r eval=FALSE}
library(brapi)

con = ba_connect() # the standard parameter will work connect to a running local mock server

# Optionally: authenticate yourself

con = ba_connect(user = "user", password = "password") %>% ba_login()

ba_crops(con) # which crops are available

ba_calls(con) # which calls are available


```


# NEW: Testing the calls

BrAPI calls are now being extensively tested using the testthat framework. The local tests are being executed against the local mock_server instance. If not present a warning message will be displayed.

Quick start in RStudio: Ctrl + Shift + T

# NEW: return tables

- all R functions using the brapi have a new parameter: rclass which can have up to five different values: json, list, data.frame, tibble, vector. The default value is tibble for most functions - that is it will alwways return a table. Vector is default for very small return objects like in the case of 'crops'.

- also: all R functions are checked against the list of calls provided by the server. That is: if a certain server does not implement all calls the corresponding R functions will not 'insist' calling it.








