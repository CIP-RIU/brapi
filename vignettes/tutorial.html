<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Reinhard Simon" />

<meta name="date" content="2018-11-14" />

<title>Basic Tutorial</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Basic Tutorial</h1>
<h4 class="author"><em>Reinhard Simon</em></h4>
<h4 class="date"><em>2018-11-14</em></h4>



<table>
<tbody>
<tr class="odd">
<td>This package is under development. It has not yet been exhaustively tested for all calls neither. Usage may also still change. If you have suggestions please use the issue tracker.</td>
</tr>
</tbody>
</table>
<div id="get-started-with-real-data" class="section level1">
<h1>Get started with real data</h1>
<p>Here we use as an example the sweetpotatobase.org database since it has currently one of the most complete implementations. Also, data are public and no login credentials are needed. It is part of the white list of the internal databases, too. So no further knowledge of configuration details are needed.</p>
<div id="get-the-database-handle" class="section level2">
<h2>Get the database handle</h2>
<p>The package comes with a list of known databases (white list). Both the white list and the handle can be printed in summary form to the console. The $ sign can be used to access individual slots and overwrite values. This can also be used as a template to configure a handle to another brapi compliant database.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(brapi)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">white_list &lt;-<span class="st"> </span><span class="kw">ba_db</span>()</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co"># print names of databases from whitelist</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">white_list</a></code></pre></div>
<pre><code>## apiary
## bms_test
## cassavabase
## cropontology
## eu_sol
## genesys
## germinate_test
## icrisat_prod
## mgis
## musabase
## ricebase
## snpseek
## sweetpotatobase
## t3s
## testserver
## tto
## ttw
## yambase</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">sp_base &lt;-<span class="st"> </span><span class="kw">ba_db</span>()<span class="op">$</span>sweetpotatobase</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co"># print summary of sp_base object</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">sp_base</a></code></pre></div>
<pre><code>## Crop = SweetPotato
## 
## Addres:Port = sweetpotatobase.org:80
## User =</code></pre>
</div>
<div id="switching-on-information-on-server-connectiviy" class="section level2">
<h2>Switching on information on server connectiviy</h2>
<p>In many cases when exploring a new database it will be useful to get any feedback from the server. The package provides a switch that allows to turn on or off such log information.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">ba_show_info</span>(<span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="listing-available-calls" class="section level2">
<h2>Listing available calls</h2>
<p>The brapi community and standard allows currently a large degree of freedom on implementation of individual parts of the standard (or calls). One call lists the functionality supported by the server.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">ba_calls</span>(sp_base)</a></code></pre></div>
<pre><code>## URL call was: https://sweetpotatobase.org/brapi/v1/calls?pageSize=1000&amp;page=0</code></pre>
<pre><code>## Waiting for response from server: ...</code></pre>
<pre><code>## Server status:  ok!</code></pre>
<pre><code>## Status details from Server:</code></pre>
<pre><code>## 
## Infos:</code></pre>
<pre><code>## </code></pre>
<pre><code>## 
## Successes:</code></pre>
<pre><code>## </code></pre>
<pre><code>## 
## Errors:</code></pre>
<pre><code>## </code></pre>
<pre><code>## No encoding supplied: defaulting to UTF-8.</code></pre>
<pre><code>## Returning page 0 (max. 0) with max. 1000 items (out of a total of 48).</code></pre>
<pre><code>## # A tibble: 48 x 4
##    versions methods      datatypes call                                    
##  * &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;                                   
##  1 1.0; 1.2 POST; DELETE json      token                                   
##  2 1.0; 1.2 GET          json      calls                                   
##  3 1.0; 1.2 GET          json      observationlevels                       
##  4 1.0; 1.2 GET; POST    json      germplasm-search                        
##  5 1.0; 1.2 GET          json      germplasm/{germplasmDbId}               
##  6 1.0; 1.2 GET          json      germplasm/{germplasmDbId}/pedigree      
##  7 1.0; 1.2 GET          json      germplasm/{germplasmDbId}/progeny       
##  8 1.0; 1.2 GET          json      germplasm/{germplasmDbId}/markerprofiles
##  9 1.0; 1.2 GET          json      germplasm/{germplasmDbId}/attributes    
## 10 1.0; 1.2 GET          json      attributes                              
## # ... with 38 more rows</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">ba_show_info</span>(<span class="ot">FALSE</span>)</a></code></pre></div>
<p>As you notice, the table is presented as a tibble. This has the advantage that it fits on the screen always even though there are big tables. But sometimes it may be useful to just print out the whole table. How to do that is the topic of the next section.</p>
</div>
<div id="function-design" class="section level2">
<h2>Function design</h2>
<p>All functions always have two parameters: the first is always the database handle or connection details (‘con’), the last is always the R class of the returned object. Most parameters should be of class ‘character’. Exceptions are: the con parameter is always a list; the parameters ‘page’ and ‘pageSize’ if applicable are integers. For details see individual functions.</p>
</div>
<div id="output-formats" class="section level2">
<h2>Output formats</h2>
<p>This is by default a tibble. However, there are several others supported. An alternative is the ‘data.frame’. In addition and mainly for debugging purposes you can set the value to ‘json’ which will return the full response json object; or you can set it to ‘list’ which will return a list equivalent.</p>
<p>So, let’s just print out the whole data.frame.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">ba_calls</span>(<span class="dt">con =</span> sp_base, <span class="dt">rclass =</span> <span class="st">&quot;data.frame&quot;</span>)</a></code></pre></div>
<pre><code>## No encoding supplied: defaulting to UTF-8.</code></pre>
<pre><code>##    versions      methods           datatypes
## 1  1.0; 1.2 POST; DELETE                json
## 2  1.0; 1.2          GET                json
## 3  1.0; 1.2          GET                json
## 4  1.0; 1.2    GET; POST                json
## 5  1.0; 1.2          GET                json
## 6  1.0; 1.2          GET                json
## 7  1.0; 1.2          GET                json
## 8  1.0; 1.2          GET                json
## 9  1.0; 1.2          GET                json
## 10 1.0; 1.2          GET                json
## 11 1.0; 1.2          GET                json
## 12 1.0; 1.2          GET                json
## 13 1.0; 1.2          GET                json
## 14 1.0; 1.2          GET                json
## 15 1.0; 1.2    GET; POST json; tsv; csv; xls
## 16 1.0; 1.2    GET; POST json; tsv; csv; xls
## 17 1.0; 1.2    GET; POST                json
## 18 1.0; 1.2          GET                json
## 19 1.0; 1.2    GET; POST                json
## 20 1.0; 1.2    GET; POST                json
## 21 1.0; 1.2    GET; POST                json
## 22 1.0; 1.2          GET                json
## 23 1.0; 1.2    GET; POST                json
## 24 1.0; 1.2          GET                json
## 25 1.0; 1.2          GET                json
## 26 1.0; 1.2          GET                json
## 27 1.0; 1.2          GET                json
## 28 1.0; 1.2          GET json; csv; xls; tsv
## 29 1.0; 1.2          GET                json
## 30 1.0; 1.2          GET                json
## 31 1.0; 1.2    GET; POST                json
## 32 1.0; 1.2    GET; POST                json
## 33 1.0; 1.2    GET; POST                json
## 34 1.0; 1.2    GET; POST                json
## 35 1.0; 1.2          GET                json
## 36 1.0; 1.2          GET                json
## 37 1.0; 1.2          GET                json
## 38 1.0; 1.2          GET                json
## 39 1.0; 1.2          GET                json
## 40 1.0; 1.2          GET                json
## 41 1.0; 1.2          GET                json
## 42 1.0; 1.2          GET                json
## 43 1.0; 1.2          GET                json
## 44 1.0; 1.2          GET                json
## 45 1.0; 1.2          GET                json
## 46 1.0; 1.2    GET; POST                json
## 47 1.0; 1.2    GET; POST                json
## 48 1.0; 1.2          GET                json
##                                        call
## 1                                     token
## 2                                     calls
## 3                         observationlevels
## 4                          germplasm-search
## 5                 germplasm/{germplasmDbId}
## 6        germplasm/{germplasmDbId}/pedigree
## 7         germplasm/{germplasmDbId}/progeny
## 8  germplasm/{germplasmDbId}/markerprofiles
## 9      germplasm/{germplasmDbId}/attributes
## 10                               attributes
## 11                    attributes/categories
## 12                           markerprofiles
## 13       markerprofiles/{markerprofileDbId}
## 14                   markerprofiles/methods
## 15                      allelematrix-search
## 16                    allelematrices-search
## 17                                 programs
## 18                                    crops
## 19                                  seasons
## 20                               studytypes
## 21                                   trials
## 22                       trials/{trialDbId}
## 23                           studies-search
## 24                      studies/{studyDbId}
## 25            studies/{studyDbId}/germplasm
## 26 studies/{studyDbId}/observationvariables
## 27     studies/{studyDbId}/observationunits
## 28                studies/{studyDbId}/table
## 29               studies/{studyDbId}/layout
## 30         studies/{studyDbId}/observations
## 31                        phenotypes-search
## 32                  phenotypes-search/table
## 33                    phenotypes-search/tsv
## 34                    phenotypes-search/csv
## 35                                   traits
## 36                       traits/{traitDbId}
## 37                                     maps
## 38                           maps/{mapDbId}
## 39                 maps/{mapDbId}/positions
## 40              maps/{mapDbId}/positions/id
## 41                                locations
## 42                      variables/datatypes
## 43                               ontologies
## 44                                variables
## 45      variables/{observationVariableDbId}
## 46                         variables-search
## 47                           samples-search
## 48                     samples/{sampleDbId}</code></pre>
</div>
<div id="getting-phenotypic-data" class="section level2">
<h2>Getting phenotypic data</h2>
<p>The brapi models trial data in a three layer hierarchy: a) breeding program which has b) trials that c) may consist of one or more studies at one or more locations. A study at one location is also often referred to as a fieldbook.</p>
<div id="which-breeding-programs-are-there" class="section level3">
<h3>Which breeding programs are there?</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">ba_programs</span>(sp_base, <span class="dt">rclass =</span> <span class="st">&quot;data.frame&quot;</span>)</a></code></pre></div>
<pre><code>## No encoding supplied: defaulting to UTF-8.</code></pre>
<pre><code>##    commonCropName leadPerson       name programDbId abbreviation
## 1     SweetPotato            Mozambique         135             
## 2     SweetPotato                Uganda         137             
## 3     SweetPotato                 Ghana         140             
## 4     SweetPotato                  NCSU         132             
## 5     SweetPotato                  Lima         167             
## 6     SweetPotato             GT4SP-CIP         293             
## 7     SweetPotato                 Kenya        1264             
## 8     SweetPotato                   RAB        1282             
## 9     SweetPotato                 INERA        1286             
## 10    SweetPotato                  AARC        1288             
## 11    SweetPotato                  CNRA        1281             
## 12    SweetPotato                  BARS        1283             
## 13    SweetPotato                 ISABU        1284             
## 14    SweetPotato             FIFAMANOR        1285             
## 15    SweetPotato                   ARC        1287             
## 16    SweetPotato                 NRCRI        1289             
##                            objective
## 1                         Mozambique
## 2                             Uganda
## 3                              Ghana
## 4  NCSU Sweetpotato Breeding Program
## 5   Sweetpotato Breeding program CIP
## 6     Genomics Tools for Sweetpotato
## 7              Demo Breeding Program
## 8                             Rubona
## 9                        Ouagadougou
## 10                           Hawassa
## 11                            Bouake
## 12                           Thyolo 
## 13                            Gisozi
## 14                         Antsirabe
## 15                          Pretoria
## 16                             Iresi</code></pre>
</div>
<div id="which-studies-are-there" class="section level3">
<h3>Which studies are there?</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">ba_studies_search</span>(sp_base, <span class="dt">programDbId =</span> <span class="st">&quot;140&quot;</span>)</a></code></pre></div>
<pre><code>## No encoding supplied: defaulting to UTF-8.</code></pre>
<pre><code>## # A tibble: 237 x 15
##    seasons active programName name  locationDbId studyType trialDbId
##  * &lt;chr&gt;   &lt;lgl&gt;  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;    
##  1 2015    TRUE   Ghana       15ay~ 16           Advanced~ 230      
##  2 2015    TRUE   Ghana       15FO~ 18           &lt;NA&gt;      230      
##  3 2015    TRUE   Ghana       15FO~ 26           &lt;NA&gt;      230      
##  4 2015    TRUE   Ghana       15HS~ 28           &lt;NA&gt;      230      
##  5 2015    TRUE   Ghana       15HS~ 26           &lt;NA&gt;      230      
##  6 2016    TRUE   Ghana       16CI~ 22           phenotyp~ 232      
##  7 2016    TRUE   Ghana       16CI~ 16           phenotyp~ 232      
##  8 2010    TRUE   Ghana       2010~ 38           Advanced~ 284      
##  9 2010    TRUE   Ghana       2010~ 16           Advanced~ 284      
## 10 2010    TRUE   Ghana       2010~ 39           Advanced~ 284      
## # ... with 227 more rows, and 8 more variables: endDate &lt;chr&gt;,
## #   trialName &lt;chr&gt;, locationName &lt;chr&gt;, programDbId &lt;chr&gt;,
## #   startDate &lt;chr&gt;, studyDbId &lt;chr&gt;, design &lt;chr&gt;, description &lt;chr&gt;</code></pre>
</div>
<div id="get-a-study-or-fieldbook" class="section level3">
<h3>Get a study (or fieldbook)</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># Currently not working!!!</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="co">#dt = ba_studies_table(sp_base, </span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="co">#                      studyDbId = &quot;151&quot;)</span></a></code></pre></div>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
